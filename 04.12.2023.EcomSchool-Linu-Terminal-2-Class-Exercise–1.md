Go to https://attack.mitre.org and Use `tshark` from the terminal and send its output to a file named “shark.txt’ and its errors to “shark_error.txt”.

this are few lines off tshark output:

2023-09-30 08:30:45 192.168.1.111 GET /index.html 200 OK
2023-09-30 08:32:15 192.168.1.122 POST /login 401 Unauthorized
2023-09-30 08:34:22 192.168.1.155 GET /page1 404 Not Found
2023-09-30 08:36:50 192.168.1.104 POST /submit 500 Internal Server Error

this tshark output writen as tamplate and have seven segaments:

first segament is the date
second segament is the time
third segament is the ip address
fourth segament is the http method
fifth segament is the url payload
sixth segament is the status code number
seventh segament is the status code description

use tshark and write a bash commands to get the tshark output as uman readable format and save it in 2 filesa according to the following logic:

if status number less then 400 write the line to ./Document/shark.txt
else if status code is above 400 write the line to ./Document/shark_error.txt

you can use only this commands to get the same out put and write it as a tshark command and only in one line: 

grep
cut
sort
uniq
head
tail
pip
tee

 
result:
-------

tshark -T fields -e frame.time -e ip.src -e http.request.method -e http.request.uri -e http.response.code -e http.response.phrase -E separator=" " | grep -oE '^[^ ]+ [^ ]+ [^ ]+ [^ ]+ [^ ]+ [^ ]+ [^ ]+' | cut -d ' ' -f 6- | tee >(grep -E '^[0-3]?[0-9][0-9]$' > /tmp/shark.txt) >(grep -E '^[4-5][0-9][0-9]$' > /tmp/shark_error.txt) > /dev/null



Explanation:
-------------

tshark -T fields -e frame.time -e ip.src -e http.request.method -e http.request.uri -e http.response.code -e http.response.phrase -E separator=" ":

tshark: The command-line tool for Wireshark.

-T fields: Specifies the output format as fields.

-e frame.time -e ip.src -e http.request.method -e http.request.uri -e http.response.code -e http.response.phrase: Specifies the fields to be extracted from each packet.

-E separator=" ": Specifies the separator between fields as a space.

grep -oE '^[^ ]+ [^ ]+ [^ ]+ [^ ]+ [^ ]+ [^ ]+ [^ ]+':

grep -oE: Searches for a pattern and prints only the matched parts.
'^[^ ]+ [^ ]+ [^ ]+ [^ ]+ [^ ]+ [^ ]+ [^ ]+': Matches lines that start with seven fields separated by spaces.
cut -d ' ' -f 6-:

cut -d ' ': Specifies the delimiter as a space.
-f 6-: Selects the 6th field and all subsequent fields.
tee >(grep -E '^[0-3]?[0-9][0-9]$' > /tmp/shark.txt) >(grep -E '^[4-5][0-9][0-9]$' > /tmp/shark_error.txt) > /dev/null:

tee: Redirects the output to multiple files and the standard output.

>(grep -E '^[0-3]?[0-9][0-9]$' > /tmp/shark.txt): Redirects lines matching the pattern [0-3]?[0-9][0-9] to /tmp/shark.txt.

>(grep -E '^[4-5][0-9][0-9]$' > /tmp/shark_error.txt): Redirects lines matching the pattern [4-5][0-9][0-9] to /tmp/shark_error.txt.

> /dev/null: Discards the standard output (so it doesn't appear in the terminal).

In summary, this command uses tshark to extract specific fields from packet data, then uses a combination of grep, cut, and tee to filter and redirect lines based on certain conditions (status codes) to different files (/tmp/shark.txt and /tmp/shark_error.txt). The > /dev/null is used to suppress the standard output from appearing on the terminal. Replace /tmp/ with the desired directory path.





